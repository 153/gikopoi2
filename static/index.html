<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv='X-UA-Compatible' content='IE=edge' />
    <link rel='stylesheet' href='style/main.css' />
    <script src="https://www.WebRTC-Experiment.com/RecordRTC.js"></script>
    <title>BARギコっぽいONLINE</title>
</head>

<body>
    <div id="vue-app" v-cloak>
        <div id="login-page" v-if="!loggedIn">
            <h1>Gikopoi 2</h1>
            <form>
                <label>User Name:</label> <input type="text" v-model="username" />
                <button v-on:click="login">Login</button>
            </form>
        </div>
        <div id="stage" v-if="loggedIn">
            <h2 class="big-red-alert" v-if="connectionLost">
                Connection lost, please refresh the
                page!　<br />接続できません、ページをリフレッシュしてください！
            </h2>
            <h2 class="big-red-alert" v-if="steppingOnPortalToNonAvailableRoom">
                This room is not available yet. Sorry!<br />
                まだ部屋の用意ができていません。ごめんね！
            </h2>
            <div id="canvas-container">
                <canvas id="room-canvas" width="721px" height="511px" tabindex="0"></canvas>
                <div id="infobox-container">
                    <div id="infobox" class="hidden">
                        <div id="infobox-area" class="infobox-line">
                            <div class="infobox-title">ｴﾘｱ：</div>
                            <div class="infobox-value">海辺の町</div>
                        </div>
                        <div id="infobox-roomname" class="infobox-line">
                            <div class="infobox-title">ｽﾃｰｼﾞ：</div>
                            <div class="infobox-value">{{ roomname }}</div>
                        </div>
                        <div id="infobox-username" class="infobox-line">
                            <div class="infobox-title">名前：</div>
                            <div class="infobox-value">{{ username }}</div>
                        </div>
                        <div id="infobox-usercount" class="infobox-line">
                            <div class="infobox-title">人数：</div>
                            <div class="infobox-value">{{ serverStats.userCount }}</div>
                        </div>
                    </div>
                    <button id="infobox-button" class="canvas-button-top-right"></button>
                </div>
            </div>
            <div id="video-streams">
                <video id="local-video" autoplay muted></video>
                <div v-for="(streamSlot, index) in currentRoomStreamSlots">
                    <div v-if="streamSlot.isActive">
                        配信者: {{ streamSlot.userName }}
                    </div>
                    <button :id="'start-streaming-button-' + index"
                        v-if="!streamSlot.isActive && !iAmStreaming && !wantToStream"
                        v-on:click="wantToStartStreaming(index)">
                        配信
                    </button>
                    <div v-show="streamSlot.isActive" :id="'received-video-' + index"></div>
                    <button :id="'stop-streaming-button-' + index"
                        v-if="iAmStreaming && streamSlotIdInWhichIWantToStream == index" v-on:click="stopStreaming">
                        配信停止
                    </button>
                </div>
            </div>
            <div id="toolbar">
                Input: <input id="input-textbox" type="text"></input>
                <button id="send-button">発言</button>

                <div id="movement-buttons">
                    <button id="btn-move-left">←</button>
                    <button id="btn-move-up">↑</button>
                    <button id="btn-move-down">↓</button>
                    <button id="btn-move-right">→</button>
                </div>

                <!-- <button id="logout">Logout</button> -->
            </div>
            ログ：
            <div id="chatLog">
            </div>

            <audio id="message-sound" src="message.mp3"></audio>
            <audio id="login-sound" src="login.mp3"></audio>
            <audio id="connection-lost-sound" src="connection-lost.mp3"></audio>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src='third/jquery.js'></script>
    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src='scripts/main.js'></script>

    <script>

    </script>
</body>

</html>
